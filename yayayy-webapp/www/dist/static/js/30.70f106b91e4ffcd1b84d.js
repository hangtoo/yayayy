webpackJsonp([30],{EfiO:function(e,t,o){t=e.exports=o("FZ+f")(!1),t.push([e.i,".handle-box[data-v-30d89816]{margin-bottom:20px;line-height:40px}.handle-select[data-v-30d89816]{width:120px}.handle-input[data-v-30d89816]{width:150px;display:inline-block}",""])},HHyU:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container calendar-list-container"},[o("div",{staticClass:"handle-box"},[o("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"活动名称"},model:{value:e.searchForm.promotion_name,callback:function(t){e.$set(e.searchForm,"promotion_name",t)},expression:"searchForm.promotion_name"}}),e._v(" "),o("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"活动编号",type:"number"},model:{value:e.searchForm.promotion_id,callback:function(t){e.$set(e.searchForm,"promotion_id",t)},expression:"searchForm.promotion_id"}}),e._v(" "),o("el-date-picker",{attrs:{editable:!1,placeholder:"创建时间(起)",type:"datetime"},model:{value:e.searchForm.searchbegintime,callback:function(t){e.$set(e.searchForm,"searchbegintime",t)},expression:"searchForm.searchbegintime"}}),e._v(" "),o("el-date-picker",{attrs:{editable:!1,placeholder:"创建时间(终)",type:"datetime"},model:{value:e.searchForm.searchendtime,callback:function(t){e.$set(e.searchForm,"searchendtime",t)},expression:"searchForm.searchendtime"}}),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.handleReset}},[e._v("重置")])],1)],1),e._v(" "),o("div",{staticClass:"handle-box"},[o("el-button-group",[o("el-button",{attrs:{size:"primary",type:"primary",icon:"el-icon-search"},on:{click:e.handleLook}},[e._v("查看")]),e._v(" "),o("el-button",{attrs:{size:"primary",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")]),e._v(" "),o("el-button",{attrs:{size:"primary",type:"warning",icon:"el-icon-edit"},on:{click:e.handleEdit}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"primary",type:"danger",icon:"el-icon-delete"},on:{click:e.handleDelete}},[e._v("删除")])],1)],1),e._v(" "),o("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.data,border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.handleSort}},[o("el-table-column",{attrs:{type:"index",label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-radio",{attrs:{label:t.$index+1},nativeOn:{change:function(o){e.getCurrentRow(t.$index+1,t.row)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"promotion_name",label:"活动名称","min-width":"200",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"promotion_id",label:"活动编号",width:"150",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"begintime",label:"活动开始时间",width:"180",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"endtime",label:"活动结束时间",width:"180",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"promotion_interface",label:"活动接口","min-width":"150"}}),e._v(" "),o("el-table-column",{attrs:{prop:"promotion_amt_string",label:"活动预算(元)",width:"130",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"createtime",label:"创建时间",width:"180",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"creater",label:"创建人",width:"140",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"180"}})],1),e._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{layout:"prev, pager, next",total:e.searchForm.totalRow},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),o("el-dialog",{attrs:{title:"查看",visible:e.dialogLookVisible},on:{"update:visible":function(t){e.dialogLookVisible=t}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.lookloading,expression:"lookloading"}]},[o("div",{staticClass:"handle-box"},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:10}},[o("span",[e._v("活动名称： "+e._s(e.editForm.promotion_name))])]),e._v(" "),o("el-col",{attrs:{span:10}},[o("span",[e._v("活动编号： "+e._s(e.editForm.promotion_id))])])],1)],1),e._v(" "),o("div",{staticClass:"handle-box"},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:10}},[o("span",[e._v("活动预算： "+e._s(e.editForm.promotion_amt_string))])]),e._v(" "),o("el-col",{attrs:{span:10}},[o("span",[e._v("有效时间： "+e._s(e.editForm.begintime)+" - "+e._s(e.editForm.endtime))])])],1)],1),e._v(" "),o("div",{staticClass:"handle-box"},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:10}},[o("span",[e._v("活动接口： "+e._s(e.editForm.promotion_interface))])]),e._v(" "),o("el-col",{attrs:{span:10}},[o("span",[e._v("创建时间： "+e._s(e.editForm.createtime))])])],1)],1),e._v(" "),o("div",{staticClass:"handle-box"},[o("span",[e._v("活动类型： "+e._s(e.editForm.promotion_type_str))])]),e._v(" "),o("div",{staticClass:"handle-box"},[o("span",[e._v("活动参数： "+e._s(e.editForm.promotion_json))])]),e._v(" "),o("div",{staticClass:"handle-box"},[o("span",[e._v("活动规则：")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.look.detail,expression:"!look.detail"}]},[e._v(" "+e._s(e.look.detailstr))]),e._v(" "),o("el-input",{directives:[{name:"show",rawName:"v-show",value:e.look.detail,expression:"look.detail"}],attrs:{maxlength:511,autosize:{minRows:2,maxRows:6},type:"textarea"},model:{value:e.editForm.detail,callback:function(t){e.$set(e.editForm,"detail",t)},expression:"editForm.detail"}})],1),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.look.detail,expression:"!look.detail"}],on:{click:function(t){e.look.detail=!0}}},[e._v("编辑规则")]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:e.look.detail,expression:"look.detail"}],attrs:{type:"primary"},on:{click:e.handleSaveDetail}},[e._v("保存")]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:e.look.detail,expression:"look.detail"}],on:{click:function(t){e.look.detail=!1}}},[e._v("取消编辑")]),e._v(" "),o("div",{staticClass:"handle-box"},[o("span")]),e._v(" "),o("div",{staticClass:"grid-content bg-purple-color"},[o("span",{staticClass:"el-dialog__title"},[e._v("参加活动用户名单")]),e._v(" "),o("div",[o("el-button",{on:{click:e.exportTable}},[e._v("导出表格")])],1),e._v(" "),o("div",[o("el-table",{attrs:{data:e.PromCustData}},[o("el-table-column",{attrs:{property:"custome_invest_no",label:"订单编号",align:"center","min-width":"160"}}),e._v(" "),o("el-table-column",{attrs:{property:"custom_name",label:"姓名",align:"center","min-width":"100"}}),e._v(" "),o("el-table-column",{attrs:{property:"custom_mobile",label:"注册手机号",align:"center","min-width":"120"}}),e._v(" "),o("el-table-column",{attrs:{property:"invest_amt_string",label:"投资金额(元)",align:"center","min-width":"120"}}),e._v(" "),o("el-table-column",{attrs:{property:"reward_amt_string",label:"活动奖励(元)",align:"center","min-width":"120"}}),e._v(" "),o("el-table-column",{attrs:{property:"use_flag",label:"奖励状态",align:"center","min-width":"100"}})],1)],1)]),e._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{layout:"prev, pager, next",total:e.userForm.totalRow},on:{"current-change":e.handleLookChange}})],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"活动管理",visible:e.dialogFormVisible,size:"tiny"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:e.editForm,attrs:{model:e.editForm,"label-width":"100px"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editForm.id,expression:"editForm.id"}],attrs:{type:"hidden"},domProps:{value:e.editForm.id},on:{input:function(t){t.target.composing||e.$set(e.editForm,"id",t.target.value)}}}),e._v(" "),o("el-form-item",{attrs:{label:"活动名称",prop:"promotion_name"}},[o("el-input",{attrs:{maxlength:19,disabled:!e.editForm.abled.promotion_name},model:{value:e.editForm.promotion_name,callback:function(t){e.$set(e.editForm,"promotion_name",t)},expression:"editForm.promotion_name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动编号",prop:"promotion_id"}},[o("el-input",{attrs:{type:"number",maxlength:15,disabled:!e.editForm.abled.promotion_id,placeholder:"例：20180315"},model:{value:e.editForm.promotion_id,callback:function(t){e.$set(e.editForm,"promotion_id",t)},expression:"editForm.promotion_id"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动类型",prop:"promotion_type"}},[o("el-select",{attrs:{filterable:"",placeholder:"请选择活动类型"},model:{value:e.editForm.promotion_type,callback:function(t){e.$set(e.editForm,"promotion_type",t)},expression:"editForm.promotion_type"}},e._l(e.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"开始时间",prop:"begintime"}},[o("el-date-picker",{attrs:{editable:!1,type:"datetime"},model:{value:e.editForm.begintime,callback:function(t){e.$set(e.editForm,"begintime",t)},expression:"editForm.begintime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"结束时间",prop:"endtime"}},[o("el-date-picker",{attrs:{editable:!1,type:"datetime"},model:{value:e.editForm.endtime,callback:function(t){e.$set(e.editForm,"endtime",t)},expression:"editForm.endtime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动接口",prop:"promotion_interface"}},[o("el-input",{attrs:{maxlength:49,placeholder:"例：activity20180315"},model:{value:e.editForm.promotion_interface,callback:function(t){e.$set(e.editForm,"promotion_interface",t)},expression:"editForm.promotion_interface"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动预算(元)",prop:"promotion_amt"}},[o("el-input",{attrs:{type:"number",maxlength:11,min:"0"},model:{value:e.editForm.promotion_amt,callback:function(t){e.$set(e.editForm,"promotion_amt",t)},expression:"editForm.promotion_amt"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动参数",prop:"promotion_json"}},[o("el-input",{model:{value:e.editForm.promotion_json,callback:function(t){e.$set(e.editForm,"promotion_json",t)},expression:"editForm.promotion_json"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{maxlength:127},model:{value:e.editForm.remark,callback:function(t){e.$set(e.editForm,"remark",t)},expression:"editForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",loading:e.editLoading},on:{click:e.handleSave}},[e._v("保存")]),e._v(" "),o("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},i=[],r={render:a,staticRenderFns:i};t.a=r},WqVD:function(e,t,o){var a=o("EfiO");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("rjj0")("5d0be48e",a,!0)},hREJ:function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=o("woOf"),r=a(i),n=o("3pLw"),l=a(n),m=o("woQ9");t.default={data:function(){return{getdataurl:"http://10.0.1.152:9999/sunvue-gateway-webapp/tPromotion/getId.do",dataurl:"http://10.0.1.152:9999/sunvue-gateway-webapp/tPromotion/dataList.do",saveurl:"http://10.0.1.152:9999/sunvue-gateway-webapp/tPromotion/save.do",savedetailurl:"http://10.0.1.152:9999/sunvue-gateway-webapp/tPromotion/savedetail.do",deleteurl:"http://10.0.1.152:9999/sunvue-gateway-webapp/tPromotion/delete.do",lookurl:"http://10.0.1.152:9999/sunvue-gateway-webapp/tPromotionCustomer/dataList.do",dialogFormVisible:!1,dialogLookVisible:!1,editLoading:!1,editForm:{promotion_name:"",promotion_id:"",begintime:"",endtime:"",promotion_interface:"",promotion_amt:"",promotion_amt_string:"",promotion_type:"",promotion_type_str:"",promotion_json:"",createtime:"",creater:"",remark:"",detail:"",abled:{promotion_name:!0,promotion_id:!0,begintime:!0,endtime:!0,promotion_interface:!0,promotion_amt:!0,promotion_amt_string:!0,createtime:!0,creater:!0,remark:!0,detail:!0}},look:{detailstr:"",detail:!1},editForm_sysMenu_ids:[],searchForm:{promotion_name:"",promotion_id:"",begintime:"",endtime:"",promotion_interface:"",promotion_amt:"",promotion_type:"",promotion_json:"",createtime:"",creater:"",remark:"",detail:"",searchbegintime:"",searchendtime:"",pageNum:1,totalRow:0,pageSize:10,is_search:!1,order:""},userForm:{t_promotion_id:"",pageNum:1,totalRow:0,pageSize:10},PromCustData:[],tableData:[],allData:[],radio:"",rowData:"",loading:!1,lookloading:!1,options:[{value:"1",label:"爆款产品"}],rules:{promotion_name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],promotion_id:[{required:!0,message:"请输入活动编号",trigger:"blur"}],begintime:[{required:!0,message:"请选择开始时间",trigger:"blur"}],endtime:[{required:!0,message:"请选择结束时间",trigger:"blur"}]}}},created:function(){this.loadData()},computed:{data:function(){return this.tableData}},methods:{loadData:function(){var e=this,t=this;t.rowData="",t.radio="",l.default.post(t.dataurl,this.searchForm,function(o){t.tableData=o.data.list,t.searchForm.totalRow=o.data.totalRow;for(var a=0;a<t.tableData.length;a++){"1"==t.tableData[a].promotion_type&&(t.tableData[a].promotion_type_str="爆款产品"),null!=t.tableData[a].createtime&&(t.tableData[a].createtime=(0,m.fdate)(t.tableData[a].createtime)),null!=t.tableData[a].begintime&&(t.tableData[a].begintime=(0,m.fdate)(t.tableData[a].begintime)),null!=t.tableData[a].endtime&&(t.tableData[a].endtime=(0,m.fdate)(t.tableData[a].endtime))}e.searchForm.is_search=!1}).catch(function(t){e.$eventHub.$emit("error",t)})},handleCurrentChange:function(e){this.searchForm.pageNum=e,this.loadData()},handleSearch:function(){this.searchForm.is_search=!0,this.loadData()},handleSort:function(e){return console.log(e),this.searchForm.order=e.prop+" "+e.order.replace("ending",""),this.handleSearch(),!1},handleAdd:function(){this.dialogFormVisible=!0,this.loading=!1,this.editForm={promotion_name:"",promotion_id:"",begintime:"",endtime:"",promotion_interface:"",promotion_amt:"",createtime:"",creater:"",remark:"",detail:"",show:{detailstr:"",detail:!1},abled:{promotion_name:!0,promotion_id:!0,begintime:!0,endtime:!0,promotion_interface:!0,promotion_amt:!0,createtime:!0,creater:!0,remark:!0,detail:!0}}},handleEdit:function(){var e=this;this.loading=!1,e.radio?(e.dialogFormVisible=!0,e.editForm=(0,r.default)({},e.rowData),e.editForm.abled||(e.editForm.abled={}),e.editForm.abled.rolecode=!1,l.default.post(e.getdataurl+"?id="+e.editForm.id,{},function(t){e.editForm.promotion_name=t.data.promotion_name,e.editForm.promotion_id=t.data.promotion_id,e.editForm.begintime=t.data.begintime,e.editForm.endtime=t.data.endtime,e.editForm.promotion_interface=t.data.promotion_interface,e.editForm.promotion_amt=t.data.promotion_amt,e.editForm.promotion_type=t.data.promotion_type,e.editForm.promotion_json=t.data.promotion_json,e.editForm.createtime=t.data.createtime,e.editForm.creater=t.data.creater,e.editForm.remark=t.data.remark,e.editForm.detail=t.data.detail}).catch(function(t){e.$eventHub.$emit("error",t)})):this.$message("请选择活动")},handleLook:function(){var e=this;e.lookloading=!1,e.radio?(this.userForm.t_promotion_id=e.rowData.id,l.default.post(e.lookurl,this.userForm,function(t){e.PromCustData=t.data.list,e.allData=t.data.alllist,e.userForm.totalRow=t.data.totalRow,console.log("response=",t);for(var o=0;o<e.PromCustData.length;o++){var a=e.PromCustData[o].use_flag;"1"==a&&(e.PromCustData[o].use_flag="已使用"),"0"==a&&(e.PromCustData[o].use_flag="未使用")}for(var o=0;o<e.allData.length;o++){var i=e.allData[o].use_flag;"1"==i&&(e.allData[o].use_flag="已使用"),"0"==i&&(e.allData[o].use_flag="未使用")}e.dialogLookVisible=!0,e.editForm=(0,r.default)(e.editForm,e.rowData),e.look.detailstr=e.editForm.detail,e.look.detail=!1,e.dialogLookVisible=!0}).catch(function(t){e.$eventHub.$emit("error",t)})):this.$message("请选择活动")},handleLookChange:function(e){this.userForm.pageNum=e,this.handleLook()},handleDelete:function(){var e=this;e.radio?this.$confirm("确定删除此条活动？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.default.post(e.deleteurl,{id:e.rowData.id},function(t){e.loadData()}).catch(function(t){e.$eventHub.$emit("error",t)})}).catch(function(){}):this.$message("请选择活动")},handleReset:function(){this.searchForm.is_search=!1,this.searchForm={promotion_name:"",promotion_id:"",searchbegintime:"",searchendtime:"",is_search:!1,order:""}},handleSave:function(){var e=this,t=this;t.loading=!0,l.default.post(t.saveurl,{id:t.editForm.id,promotion_name:t.editForm.promotion_name,promotion_id:t.editForm.promotion_id,begintime:t.editForm.begintime,endtime:t.editForm.endtime,promotion_interface:t.editForm.promotion_interface,promotion_amt:t.editForm.promotion_amt,promotion_type:t.editForm.promotion_type,promotion_json:t.editForm.promotion_json,createtime:t.editForm.createtime,creater:t.editForm.creater,remark:t.editForm.remark,detail:t.editForm.detail},function(o){if(t.loading=!1,200==o.status&&o.data&&200==o.data.statusCode)return t.loadData(),void(t.dialogFormVisible=!1);e.$message.error({title:"错误",message:o.data.msg})}).catch(function(e){t.$eventHub.$emit("error",e)})},handleSaveDetail:function(){var e=this,t=this;t.lookloading=!0,l.default.post(t.savedetailurl,{id:t.editForm.id,detail:t.editForm.detail},function(o){if(t.lookloading=!1,200==o.status&&o.data&&200==o.data.statusCode)return t.look.detailstr=t.editForm.detail,t.look.detail=!1,void t.loadData();e.$message.error({title:"错误",message:o.data.msg})}).catch(function(e){t.$eventHub.$emit("error",e)})},handleFalse:function(){return!1},getCurrentRow:function(e,t){console.log("radio=",this.radio),console.log("row=",t),this.rowData=t,this.$refs.singleTable.setCurrentRow(t)},exportTable:function(){var e=this;o.e(57).then(function(){var t=(new Date).toDateString(),a=o("zWO4"),i=a.export_json_to_excel,r=["订单编号","姓名","注册手机号","投资金额（元）","活动奖励（元）","奖励状态"],n=["custome_invest_no","custom_name","custom_mobile","invest_amt_string","reward_amt_string","use_flag"],l=e.allData;i(r,e.formatJson(n,l),"参加活动用户名单"+t)}.bind(null,o)).catch(o.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})}}}},jHhW:function(e,t,o){"use strict";function a(e){o("WqVD")}Object.defineProperty(t,"__esModule",{value:!0});var i=o("hREJ"),r=o.n(i),n=o("HHyU"),l=o("VU/8"),m=a,s=l(r.a,n.a,!1,m,"data-v-30d89816",null);t.default=s.exports},woQ9:function(e,t,o){"use strict";function a(e){if(console.log("time=",e),e.length>20){return e.substring(0,10)+" "+e.substring(11,19)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.fdate=a}});